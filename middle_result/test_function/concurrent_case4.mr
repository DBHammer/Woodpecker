3,3:Connection conn=get_conn[master]
4,3:Connection conn1=get_conn[master]
5,3:Connection conn2=get_conn[master]
6,3:Connection conn3=get_conn[master]
7,3:Connection conn4=get_conn[master]
8,3:Statement stmt=get_stat[conn]
9,3:Statement stmt1=get_stat[conn1]
10,3:Statement stmt2=get_stat[conn2]
11,3:Statement stmt3=get_stat[conn3]
12,3:Statement stmt4=get_stat[conn4]
14,1:sql["drop table if exists t1,t2,t3,t4;";stmt]
15,1:sql["create table t1(f1 int, f2 int, a int, primary key(f1,f2));";stmt]
16,1:sql["insert into t1 values(1,1,1);";stmt]
17,1:sql["insert into t1 values(1,2,1);";stmt]
18,1:sql["insert into t1 values(2,1,1);";stmt]
19,1:sql["insert into t1 values(2,2,1);";stmt]
20,1:tx[conn1;start]
21,1:sql["update t1 set a=a+1 where f1=1 and f2=1;";stmt1]
22,1:sql["update t1 set a=a+1 where f1=2 and f2=1;";stmt1]
23,1:tx[conn2;start]
24,1:sql["update t1 set a=a+1 where f1=1 and f2=2;";stmt2]
25,1:sql["update t1 set a=a+1 where f1=2 and f2=2;";stmt2]
26,1:tx[conn1;commit]
27,1:tx[conn2;commit]
28,3:ResultSet rs0=sql["select * from t1;";stmt]
30,1:tx[conn1;start]
31,1:sql["update t1 set a=a+1 where f1=1 and f2=1;";stmt1]
32,1:sql["update t1 set a=a+1 where f1=2 and f2=2;";stmt1]
33,1:tx[conn3;start]
34,1:sql["update t1 set a=a+1 where f1=2 and f2=1;";stmt3]
35,1:tx[conn2;start]
36,1:sql["update t1 set a=a+1 where f1=1 and f2=2;";stmt2]
37,1:tx[conn2;rollback]
38,1:tx[conn1;commit]
39,1:tx[conn3;commit]
40,3:ResultSet rs1=sql["select * from t1;";stmt]
42,1:tx[conn1;start]
43,1:sql["update t1 set a=a+1 where f1=1;";stmt1]
44,1:tx[conn1;rollback]
45,3:ResultSet rs2=sql["select * from t1;";stmt]
49,0:IdealResultSet<int,int,int> irs0
51,0:IdealResultSet<int,int,int> irs1
53,0:IdealResultSet<int,int,int> irs2
55,1:import_irs["concurrent_case4"][irs0 0,irs1 1,irs2 2]
57,1:verify[rs0;==;irs0]
58,1:verify[rs1;==;irs1]
59,1:verify[rs2;==;irs2]
